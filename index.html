<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Painel √önico - Batalh√£o ROTA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            rota: {
              bg: "#020617",
              card: "rgba(15,23,42,0.95)",
              accent: "#22c55e",
              accentSoft: "rgba(34,197,94,0.20)",
              accentStrong: "rgba(34,197,94,0.35)",
            },
          },
          boxShadow: {
            "inner-glow": "0 0 25px rgba(34,197,94,0.35)",
          },
        },
      },
    };
  </script>

  <!-- React & ReactDOM via CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- √çcones -->
  <link rel="icon" href="https://i.imgur.com/rA8xIGT.png" />
</head>
<body class="bg-slate-950 min-h-screen text-slate-50 antialiased">
  <div id="root"></div>

  <script type="text/babel">
    // ----------------- CONFIGURA√á√ïES B√ÅSICAS -----------------

    // Links "crus" (originais) para os sistemas e docs
    const RAW_LINKS = {
      // Sistemas
      ponto: "https://gabrielsaleh1.github.io/Ponto-Online",
      rso: "https://gabrielsaleh1.github.io/RSO-Online",

      // Hierarquia travada em leitura (par√¢metro + sandbox)
      hierarquia: "https://gabrielsaleh1.github.io/Hierarquia?view=1",

      // Documentos do Batalh√£o
      fardamentos: "docs.google.com/spreadsheets/u/1/d/15q-J8zUxIMMAAp_ssNFRrNsddTfGIJHVP241RUw3J4/edit?usp=sharing",
      doutrinas: "https://docs.google.com/document/d/1LPXXQl9Ux7o3iEy8zCpRePdtH_zCRyUnKS1Bkj_bLjE/edit?usp=sharing",
      secoes: "https://docs.google.com/spreadsheets/d/1Rw6o7O1rAjVC4XCDFwe6L0vInKSQsBvYZsWm6Rb1pfE/edit?gid=0#gid=0",
      crimes: "https://docs.google.com/document/d/1iGnC80f9COCirKVGHYm5Nr9xSr6hodYHCDl3IAXZvoY/edit?tab=t.0",
      planilhaGeral: "https://docs.google.com/spreadsheets/d/1tNkMNbSzPn1qSgkKUlZQzOzJo6AwBd-STesfG_Sav6w/edit?usp=sharing",
    };

    // Converte links do Google Docs/Sheets para /preview (melhor para iframe)
    function toEmbedUrl(url) {
      if (!url) return url;
      if (!/^https?:\/\//i.test(url)) url = "https://" + url;
      try {
        const u = new URL(url);
        if (u.hostname !== "docs.google.com") return url;
        const parts = u.pathname.split("/").filter(Boolean);
        const type = parts[0]; // "document" | "spreadsheets" | ...
        const idIndex = parts.findIndex(p => p === "d");
        if (idIndex === -1 || !parts[idIndex + 1]) return url;
        const fileId = parts[idIndex + 1];

        let basePreviewPath = "";
        if (type === "document") {
          basePreviewPath = `/document/d/${fileId}/preview`;
        } else if (type === "spreadsheets") {
          basePreviewPath = `/spreadsheets/d/${fileId}/preview`;
        } else {
          // Se for outro tipo, deixa como est√°
          return url;
        }

        const previewUrl = new URL(`https://docs.google.com${basePreviewPath}`);
        // Mant√©m par√¢metros relevantes (tipo gid, tab, etc)
        u.searchParams.forEach((value, key) => {
          previewUrl.searchParams.set(key, value);
        });
        return previewUrl.toString();
      } catch (e) {
        console.error("Erro ao transformar URL em preview:", e);
        return url;
      }
    }

    // ----------------- DADOS DAS SE√á√ïES -----------------

    const SECTIONS = [
      {
        label: "Sistemas Internos",
        items: [
          {
            id: "ponto",
            name: "Ponto Online",
            url: RAW_LINKS.ponto,
            icon: "‚è±Ô∏è",
            desc: "Registro de ponto dos policiais.",
            tag: "SISTEMA",
            sandbox: "allow-scripts allow-same-origin",
          },
          {
            id: "rso",
            name: "RSO Online",
            url: RAW_LINKS.rso,
            icon: "üìã",
            desc: "Registro de Servi√ßo Operacional.",
            tag: "SISTEMA",
            sandbox: "allow-scripts allow-same-origin",
          },
        ],
      },
      {
        label: "Controle Operacional",
        items: [
          {
            id: "hierarquia",
            name: "Hierarquia do Batalh√£o",
            url: RAW_LINKS.hierarquia,
            icon: "üèõÔ∏è",
            desc: "Estrutura hier√°rquica completa da unidade.",
            tag: "CONSULTA",
            sandbox: "allow-scripts allow-same-origin allow-downloads",
          },
        ],
      },
      {
        label: "Documentos do Batalh√£o",
        items: [
          {
            id: "hierarquia_doc",
            name: "Hierarquia (Documento)",
            url: RAW_LINKS.hierarquia,
            icon: "üìë",
            desc: "Documento oficial da hierarquia, em modo de visualiza√ß√£o.",
            tag: "DOC",
            sandbox: "allow-scripts allow-same-origin",
          },
          {
            id: "fardamentos",
            name: "Fardamentos do Batalh√£o",
            url: RAW_LINKS.fardamentos,
            icon: "üéΩ",
            desc: "Controle e padr√£o dos fardamentos.",
            tag: "LOG√çSTICA",
            sandbox: null,
          },
          {
            id: "doutrinas",
            name: "Doutrinas e Regimento Interno",
            url: RAW_LINKS.doutrinas,
            icon: "üìú",
            desc: "Normas, procedimentos e regras do batalh√£o.",
            tag: "NORMAS",
            sandbox: null,
          },
          {
            id: "secoes",
            name: "Se√ß√µes Internas do Batalh√£o",
            url: RAW_LINKS.secoes,
            icon: "üóÇÔ∏è",
            desc: "Organiza√ß√£o das se√ß√µes internas.",
            tag: "ADMINISTRATIVO",
            sandbox: null,
          },
          {
            id: "crimes",
            name: "Crimes Militares",
            url: RAW_LINKS.crimes,
            icon: "‚öñÔ∏è",
            desc: "Tabela de crimes e enquadramentos.",
            tag: "LEGISLA√á√ÉO",
            sandbox: null,
          },
          {
            id: "planilha_geral",
            name: "Planilha Geral do Batalh√£o",
            url: RAW_LINKS.planilhaGeral,
            icon: "üìä",
            desc: "Planilha geral com informa√ß√µes consolidadas do batalh√£o.",
            tag: "PLANILHA",
            sandbox: null,
          },
        ],
      },
    ];

    // ----------------- COMPONENTES -----------------
    function Sidebar({ sections, activeId, onSelect }) {
      return (
        <aside className="w-80 shrink-0 border-r border-white/10 bg-slate-950/60 backdrop-blur-xl p-4 flex flex-col gap-4">
          {/* Cabe√ßalho da marca */}
          <div className="flex items-center gap-3 mb-2">
            <img
              src="https://i.imgur.com/rA8xIGT.png"
              alt="ROTA"
              className="w-10 h-10 rounded-xl shadow-inner shadow-black/60"
            />
            <div>
              <p className="text-xs uppercase tracking-[0.2em] text-emerald-400/80">
                Batalh√£o ROTA
              </p>
              <h1 className="font-semibold text-sm text-slate-50">
                Painel √önico Operacional
              </h1>
            </div>
          </div>

          <div className="text-[11px] leading-4 text-slate-400 bg-slate-950/60 border border-white/5 rounded-2xl px-3 py-2">
            Centralizamos aqui os principais sistemas e documentos da unidade.
            Selecione um item para abrir na direita. Use{" "}
            <span className="text-emerald-400 font-semibold">‚ÄúAbrir em nova aba‚Äù</span>{" "}
            para telas dedicadas.
          </div>

          <nav className="flex-1 overflow-y-auto pr-1 space-y-4">
            {sections.map((section) => (
              <div key={section.label} className="space-y-1">
                <h2 className="text-[11px] uppercase tracking-[0.18em] text-slate-500 px-2">
                  {section.label}
                </h2>
                <div className="mt-1 space-y-1.5">
                  {section.items.map((item) => {
                    const isActive = item.id === activeId;
                    return (
                      <button
                        key={item.id}
                        onClick={() => onSelect(item)}
                        className={[
                          "w-full flex items-center gap-3 px-3 py-2.5 rounded-2xl text-left transition-all",
                          "border border-transparent hover:border-emerald-500/40",
                          "bg-slate-900/60 hover:bg-slate-900/90",
                          "group",
                          isActive &&
                            "border-emerald-500/70 shadow-inner-glow bg-slate-900/95",
                        ]
                          .filter(Boolean)
                          .join(" ")}
                      >
                        <div className="flex items-center justify-center w-7 h-7 text-lg">
                          <span className="drop-shadow-[0_0_12px_rgba(34,197,94,0.35)]">
                            {item.icon}
                          </span>
                        </div>
                        <div className="flex-1">
                          <div className="flex items-center justify-between gap-2">
                            <p className="text-xs font-semibold text-slate-50 leading-tight">
                              {item.name}
                            </p>
                            {item.tag && (
                              <span
                                className={[
                                  "text-[9px] px-1.5 py-0.5 rounded-full border border-emerald-400/30",
                                  "bg-emerald-400/10 text-emerald-300",
                                  "uppercase tracking-[0.14em] font-semibold",
                                ].join(" ")}
                              >
                                {item.tag}
                              </span>
                            )}
                          </div>
                          <p className="text-[11px] text-slate-400 line-clamp-2 mt-0.5">
                            {item.desc}
                          </p>
                          <p className="text-[10px] text-emerald-400/90 mt-1 font-mono truncate">
                            {item.url}
                          </p>
                        </div>
                      </button>
                    );
                  })}
                </div>
              </div>
            ))}
          </nav>

          <footer className="text-[10px] text-slate-500 mt-2 px-2">
            Painel desenvolvido para facilitar o acesso r√°pido aos sistemas da
            unidade.{" "}
            <span className="text-slate-400">
              Ajuste de links pode ser feito diretamente no arquivo{" "}
              <span className="font-mono text-[10px] text-emerald-400">
                RAW_LINKS
              </span>
              .
            </span>
          </footer>
        </aside>
      );
    }

    function MainPanel({ activeItem }) {
      if (!activeItem) {
        return (
          <main className="flex-1 flex items-center justify-center bg-gradient-to-br from-slate-950 via-slate-950 to-emerald-950/40">
            <div className="max-w-md text-center px-6 py-8 rounded-3xl bg-slate-950/70 border border-white/5 shadow-xl shadow-black/40">
              <div className="inline-flex items-center justify-center w-14 h-14 rounded-2xl bg-emerald-500/15 border border-emerald-500/40 mb-4 shadow-inner-glow">
                <span className="text-2xl drop-shadow-[0_0_18px_rgba(34,197,94,0.6)]">
                  üõ°Ô∏è
                </span>
              </div>
              <h2 className="text-lg font-semibold text-slate-50 mb-2">
                Selecione um sistema ou documento
              </h2>
              <p className="text-sm text-slate-400 mb-4">
                Use o menu √† esquerda para escolher o que deseja visualizar. O
                conte√∫do ser√° aberto aqui, dentro do painel.
              </p>
              <ul className="text-xs text-slate-400 space-y-1 text-left inline-block">
                <li>‚Ä¢ Sistemas de ponto e RSO</li>
                <li>‚Ä¢ Hierarquia, doutrinas e se√ß√µes</li>
                <li>‚Ä¢ Planilhas e documentos do batalh√£o</li>
              </ul>
            </div>
          </main>
        );
      }

      const embedUrl = toEmbedUrl(activeItem.url);

      return (
        <main className="flex-1 flex flex-col bg-slate-950/80">
          {/* Top bar */}
          <div className="border-b border-white/10 bg-slate-950/80 backdrop-blur-xl px-6 py-3 flex items-center justify-between gap-3">
            <div className="flex items-center gap-3 min-w-0">
              <div className="w-9 h-9 rounded-2xl bg-emerald-500/15 border border-emerald-500/40 flex items-center justify-center shadow-inner-glow">
                <span className="text-xl drop-shadow-[0_0_16px_rgba(34,197,94,0.7)]">
                  {activeItem.icon}
                </span>
              </div>
              <div className="min-w-0">
                <h2 className="text-sm font-semibold text-slate-50 truncate">
                  {activeItem.name}
                </h2>
                <p className="text-[11px] text-slate-400 truncate">
                  {activeItem.desc}
                </p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <a
                href={
                  /^https?:\/\//i.test(activeItem.url)
                    ? activeItem.url
                    : "https://" + activeItem.url
                }
                target="_blank"
                rel="noopener noreferrer"
                className="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-2xl text-xs font-medium border border-emerald-400/60 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-300 shadow-inner-glow transition"
              >
                <span>Abrir em nova aba</span>
                <span className="text-[13px]">‚Üó</span>
              </a>
            </div>
          </div>

          {/* Iframe */}
          <div className="flex-1 bg-slate-950 relative">
            <div className="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(34,197,94,0.35),_transparent_55%),radial-gradient(circle_at_bottom,_rgba(15,23,42,1),_transparent_55%)] opacity-60 pointer-events-none" />
            <div className="relative z-10 w-full h-full p-4 sm:p-5">
              <div className="w-full h-full rounded-3xl border border-white/10 bg-black/70 overflow-hidden shadow-2xl shadow-black/50">
                <iframe
                  key={embedUrl}
                  src={embedUrl}
                  title={activeItem.name}
                  className="w-full h-full bg-slate-950"
                  loading="lazy"
                  sandbox={
                    activeItem.sandbox ||
                    "allow-forms allow-scripts allow-same-origin allow-popups"
                  }
                  referrerPolicy="no-referrer-when-downgrade"
                />
              </div>
            </div>
          </div>
        </main>
      );
    }

    function App() {
      const [activeItem, setActiveItem] = React.useState(() => {
        // Padr√£o: abre o Ponto Online
        return SECTIONS[0]?.items?.[0] || null;
      });

      return (
        <div className="min-h-screen bg-slate-950 text-slate-50 flex">
          <div className="fixed inset-0 pointer-events-none opacity-50">
            <div className="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(34,197,94,0.25),_transparent_60%),radial-gradient(circle_at_bottom,_rgba(15,23,42,1),_transparent_60%)]" />
          </div>

          <div className="relative z-10 flex flex-1 max-w-7xl mx-auto w-full">
            <Sidebar
              sections={SECTIONS}
              activeId={activeItem?.id}
              onSelect={setActiveItem}
            />
            <MainPanel activeItem={activeItem} />
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
